import{r as i,j as e}from"./vendor-DU2oVBwu.js";import{k as f,p as P,u as C,b as k,c as I,d as O}from"./index-CF1KAMmK.js";class E{static async giftPlayer(d,o,c){if(d.role!=="Owner"&&d.role!=="Admin")return{success:!1,message:"Unauthorized: Only Owner or Admin can gift players."};const x=await f.getUserByUsername(o);if(!x)return{success:!1,message:"User not found."};const t=P.find(l=>l.id===c);return t?(await f.giftToUser(d,x.username,{playerIds:[c]}),{success:!0,message:`Successfully gifted ${t.name} (${t.rarity}) to ${o}.`}):{success:!1,message:"Player not found."}}}const $=()=>{const{user:n,adminGift:d}=C(),[o,c]=i.useState([]),[x,t]=i.useState(!1),[l,p]=i.useState({coins:0,diamonds:0}),[g,S]=i.useState(null),[b,A]=i.useState(""),[y,j]=i.useState(""),[N,m]=i.useState(null),h=n?.username==="ThariqNoR"||n?.username==="SREEHARI"||n?.role==="Owner"||n?.role==="Admin",w=async()=>{t(!0);try{const s=await f.getAllUsers();c(s)}catch(s){console.error(s)}finally{t(!1)}};i.useEffect(()=>{if(!h)return;t(!0);const s=k(I(O,"users"),a=>{const r=a.docs.map(u=>{const v=u.data();return{...v,uid:v.uid||u.id}});c(r),t(!1)},()=>{t(!1)});return()=>{s()}},[h]);const G=async s=>{if(!(l.coins===0&&l.diamonds===0))try{await d(s,{coins:l.coins,diamonds:l.diamonds}),alert(`Gift sent to ${s}`),p({coins:0,diamonds:0}),w()}catch{alert("Error sending gift")}},U=async()=>{if(!n)return;const s=b.trim(),a=y.trim();if(!s||!a){m("Enter username and player ID");return}m("Sending player...");try{const r=await E.giftPlayer(n,s,a);m(r.message),j("")}catch(r){const u=r?.message||"Error gifting player";m(u)}};return h?e.jsxs("div",{className:"w-full h-full bg-slate-900 p-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-black italic text-red-500",children:"ADMIN CONTROL PANEL"}),e.jsx("button",{onClick:w,className:"bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded",children:"Refresh List"})]}),e.jsxs("div",{className:"mb-6 bg-slate-800 rounded-xl border border-red-500/40 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h2",{className:"text-lg font-bold text-white",children:"Gift Player By Username"})}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsx("input",{type:"text",placeholder:"Target Username",className:"min-w-[160px] bg-black/60 border border-slate-600 rounded px-3 py-2 text-sm text-white",value:b,onChange:s=>A(s.target.value)}),e.jsx("input",{type:"text",placeholder:"Player ID",className:"min-w-[140px] bg-black/60 border border-slate-600 rounded px-3 py-2 text-sm text-white font-mono",value:y,onChange:s=>j(s.target.value)}),e.jsx("button",{onClick:U,className:"bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded text-sm font-bold",children:"Send Player"}),N&&e.jsx("span",{className:"text-xs text-slate-300",children:N})]})]}),e.jsx("div",{className:"bg-slate-800 rounded-xl overflow-x-auto border border-slate-700",children:e.jsxs("table",{className:"w-full text-left text-sm text-slate-300",children:[e.jsx("thead",{className:"bg-slate-900 text-slate-400 font-bold uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Username"}),e.jsx("th",{className:"p-4",children:"Role"}),e.jsx("th",{className:"p-4",children:"Level"}),e.jsx("th",{className:"p-4",children:"Coins"}),e.jsx("th",{className:"p-4",children:"Diamonds"}),e.jsx("th",{className:"p-4",children:"Squad Size"}),e.jsx("th",{className:"p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-700",children:x?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-10 text-center",children:"Loading users..."})}):o.map(s=>e.jsxs("tr",{className:"hover:bg-slate-700/50",children:[e.jsxs("td",{className:"p-4 font-bold text-white",children:[s.username,s.uid===n.uid&&e.jsx("span",{className:"ml-2 text-[10px] bg-blue-600 px-1 rounded",children:"YOU"})]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${s.role==="Owner"?"bg-red-500/20 text-red-400":s.role==="Admin"?"bg-yellow-500/20 text-yellow-400":"bg-slate-600/20 text-slate-400"}`,children:s.role})}),e.jsx("td",{className:"p-4",children:s.level||1}),e.jsx("td",{className:"p-4 text-yellow-400",children:s.coins?.toLocaleString()||0}),e.jsx("td",{className:"p-4 text-blue-400",children:s.diamonds?.toLocaleString()||0}),e.jsx("td",{className:"p-4",children:s.squad?.length||0}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>S(g===s.username?null:s.username),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-3 py-1 rounded text-xs font-bold",children:"Gift"})}),g===s.username&&e.jsxs("div",{className:"mt-2 p-2 bg-slate-900 rounded border border-slate-700 flex gap-2 items-center animate-fadeIn",children:[e.jsx("input",{type:"number",placeholder:"Coins",className:"w-20 bg-black/50 border border-slate-600 rounded px-2 py-1 text-xs",value:l.coins||"",onChange:a=>p(r=>({...r,coins:parseInt(a.target.value)||0}))}),e.jsx("input",{type:"number",placeholder:"Gems",className:"w-20 bg-black/50 border border-slate-600 rounded px-2 py-1 text-xs",value:l.diamonds||"",onChange:a=>p(r=>({...r,diamonds:parseInt(a.target.value)||0}))}),e.jsx("button",{onClick:()=>G(s.username),className:"bg-green-600 hover:bg-green-500 text-white px-2 py-1 rounded text-xs",children:"Send"})]})]})]},s.uid))})]})})]}):e.jsx("div",{className:"p-10 text-white text-center",children:"Access Denied"})};export{$ as AdminPanel};
